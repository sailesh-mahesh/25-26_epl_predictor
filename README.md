# Premier League Table Predictor (2025/26)

This project is a simple, data-driven model to predict the final standings of the 2025/26 Premier League season. It was built using Python and machine learning techniques, combining historical football data with manual transfer window ratings. It’s my first proper project, so the focus is on building something that aligns with my interests.

---

## What It Does

- Predicts final EPL standings based on stats from past seasons.
- Uses Random Forest Regression to estimate points, goals scored, and goals conceded.
- Lets you rate each team’s summer transfer window (from -10 to +10) to directly factor in new signings and departures, influencing their predicted performance.

---

## Features

### Historical Match Data
Includes Premier League and Championship data from the last 5 seasons.

### Calculated Team Stats
- Points, Wins, Draws, Losses  
- Goals Scored, Goals Conceded, Goal Difference  
- Team Form (points from the last 10 matches of the previous season)  
- Real xG (Expected Goals) and xGA (Expected Goals Against) data  
- Long-term Premier League averages (`prev_pl_avg_points`) for historical context

### Transfer Impact Input
You manually rate each team’s transfer window (from -10 for a very negative impact to +10 for a very positive impact). This rating directly adjusts the predicted points and goals.

### Promoted/Relegated Flags
The model accounts for newly promoted or relegated clubs, using their Championship performance for context.

---

## How It Works

1. **Preprocessing** – Cleans and combines all the raw CSV files into a single, usable dataset.  
2. **Feature Engineering** – Builds comprehensive team performance statistics, creates promotion/relegation flags, calculates form and historical averages, and integrates the xG data.  
3. **Model Training** – Trains a Random Forest Regressor model on the processed historical data to learn patterns for points, goals scored, and goals conceded.  
4. **Prediction** – Prompts you for your transfer ratings, then uses the trained models to output a full Premier League table with predicted results (points, goals for, goals against, and goal difference).

---

## Project Structure

```

premier-league-predictor/
├── data/
│   ├── premier\_league/               # Raw EPL match CSVs (E0\_*.csv)
│   ├── championship/                 # Raw Championship match CSVs (E1\_*.csv)
│   ├── combined\_data.csv             # Generated by 01\_data\_preprocessing.py
│   └── final\_features\_complete.csv   # Generated by 02\_feature\_engineering.py
└── code/
├── 01\_data\_preprocessing.py
├── 02\_feature\_engineering.py
├── 02b_add_xg_features.py
├── 02c_final_data_merge.py
└── 03\_model\_training.py

````

---

## Setup

### Clone the repo

```bash
git clone https://github.com/sailesh-mahesh/25-26_epl_predictor
cd 25-26_epl_predictor
````

### (Optional) Create a virtual environment

```bash
python3 -m venv epl_pred_venv
source epl_pred_venv/bin/activate  # On Windows: .\epl_pred_venv\Scripts\activate
```

### Install dependencies

```bash
pip install pandas scikit-learn numpy
```

### Download and Prepare Match Data

* Visit [football-data.co.uk](https://www.football-data.co.uk/).
* Download EPL (E0) and Championship (E1) CSVs for seasons 2020/21 to 2024/25.
* Save them in:

```
data/premier_league/
data/championship/
```

The `code/02_feature_engineering.py` script contains the necessary real xG/xGA data.

---

## Running the Model

```bash
python code/01_data_preprocessing.py
python code/02_feature_engineering.py
python code/02b_add_xg_features.py
python code/02c_final_data_merge.py
python code/03_model_training.py
```

You'll be prompted to enter transfer ratings for each team (e.g., `+5` = excellent window, `-5` = terrible).

---

## Dependencies

* Python 3.x
* pandas
* scikit-learn
* numpy

---

## Feedback

Feel free to fork, use, or suggest improvements. Any feedback is welcome!

